(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{546:function(s,t,a){"use strict";a.r(t);var n=a(1),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("配置在"),a("code",[s._v("StreamX")]),s._v("中是非常重要的概念,先说说为什么需要配置")]),s._v(" "),a("h2",{attrs:{id:"为什么需要配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为什么需要配置"}},[s._v("#")]),s._v(" 为什么需要配置")]),s._v(" "),a("p",[s._v("开发"),a("code",[s._v("DataStream")]),s._v("程序,大体流程都可以抽象为以下4步")]),s._v(" "),a("div",{staticClass:"counter"},[a("ul",[a("li",[s._v("StreamExecutionEnvironment初始并配置")]),s._v(" "),a("li",[s._v("Source接入数据")]),s._v(" "),a("li",[s._v("Transformation逻辑处理")]),s._v(" "),a("li",[s._v("Sink结果数据落地")])])]),s._v(" "),a("p",[a("img",{attrs:{src:"http://assets.Streamxhub.com/20210317134700.png",alt:""}})]),s._v(" "),a("p",[s._v("开发"),a("code",[s._v("DataStream")]),s._v("程序都需要定义"),a("code",[s._v("Environment")]),s._v("初始化并且配置环境相关的参数,一般我们都会在第一步初始化"),a("code",[s._v("Environment")]),s._v("并配置各种参数,配置的参数大概有以下几类")]),s._v(" "),a("div",{staticClass:"counter"},[a("ul",[a("li",[s._v("Parallelism 默认并行度配置")]),s._v(" "),a("li",[s._v("TimeCharacteristic 时间特征配置")]),s._v(" "),a("li",[s._v("checkpoint 检查点的相关配置")]),s._v(" "),a("li",[s._v("Watermark 相关配置")]),s._v(" "),a("li",[s._v("State Backend 状态后端配置")]),s._v(" "),a("li",[s._v("Restart Strategy 重启策略配置")]),s._v(" "),a("li",[s._v("其他配置...")])])]),s._v(" "),a("p",[s._v("以上的配置基本都是比较普遍且通用的,是每个程序上来第一步就要定义的,是一项重复的工作")]),s._v(" "),a("p",[s._v("当程序写好后,要上线运行,任务启动提交都差不多用下面的命令行的方式,设置各种启动参数,\n这时就得开发者清楚的知道每个参数的含义,如果再设置几个运行时资源参数,那启动命名会很长,可读性很差,参数解析用到了强校验,一旦设置错误,会直接报错,导致任务启动失败,最直接的异常是 "),a("mark",[s._v("找不到程序的jar")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("flink run -m yarn-cluster -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -c com.xx.Main job.jar\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("开发"),a("code",[s._v("Flink Sql")]),s._v("程序,也需要设置一系列环境参数,除此之外,如果要使用纯sql的方式开发,举一个最简单的例子,代码如下")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flink"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("table"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EnvironmentSettings")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flink"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("table"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Table")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flink"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("table"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TableEnvironment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("JavaTableApp")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EnvironmentSettings")]),s._v(" bbSettings "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EnvironmentSettings")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("newInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("useBlinkPlanner")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TableEnvironment")]),s._v(" bsTableEnv "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TableEnvironment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("create")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("bbSettings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" sourceDDL "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CREATE TABLE datagen (  "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" f_random INT,  "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" f_random_str STRING,  "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" ts AS localtimestamp,  "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" WATERMARK FOR ts AS ts  "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('") WITH (  "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\" 'connector' = 'datagen',  \"")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\" 'rows-per-second'='10',  \"")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\" 'fields.f_random.min'='1',  \"")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\" 'fields.f_random.max'='5',  \"")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\" 'fields.f_random_str.length'='10'  \"")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('")"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        bsTableEnv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("executeSql")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sourceDDL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" sinkDDL "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CREATE TABLE print_table ("')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" f_random int,"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" c_val bigint, "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" wStart TIMESTAMP(3) "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\") WITH ('connector' = 'print') \"")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        bsTableEnv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("executeSql")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sinkDDL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br")])]),a("p",[s._v("我们会看到除了设置EnvironmentSettings参数之外,剩下的几乎大段大段的代码都是在写"),a("code",[s._v("sql")]),s._v(",用java代码拼接各种sql,这种编码的方式,极不优雅,如果业务复杂,更是难以维护,而且会发现,整个编码的模式是统一的,\n都是声明一段sql,然后调用"),a("code",[s._v("executeSql")]),s._v("方法")]),s._v(" "),a("p",[a("strong",[s._v("我们的设想是")]),s._v(":能不能以一种更好的方式将这种重复的工作简单化,将"),a("code",[s._v("DataStream")]),s._v("和"),a("code",[s._v("Flink Sql")]),s._v("任务中的一些环境初始化相关的参数和启动相关参数简化,最好一行代码都不写,针对"),a("code",[s._v("Flink Sql")]),s._v("作业,也不想在代码里写大段的sql,能不能以一种更优雅的方式解决?")]),s._v(" "),a("p",[a("strong",[s._v("答案是肯定的")])]),s._v(" "),a("p",[s._v("针对参数设置的问题,在"),a("code",[s._v("StreamX")]),s._v("中提出统一程序配置的概念,把程序的一系列参数从开发到部署阶段按照特定的格式配置到"),a("code",[s._v("application.yml")]),s._v("里,抽象出\n一个通用的配置模板,按照这种规定的格式将上述配置的各项参数在配置文件里定义出来,在程序启动的时候将这个项目配置传入到程序中即可完成环境的初始化工作,在任务启动的时候也会自动识别启动时的参数,于是就有了"),a("code",[s._v("配置文件")]),s._v("这一概念")]),s._v(" "),a("p",[s._v("针对Flink Sql作业在代码里写sql的问题,"),a("code",[s._v("StreamX")]),s._v("针对"),a("code",[s._v("Flink Sql")]),s._v("作业做了更高层级封装和抽象,开发者只需要将sql按照一定的规范要求定义到"),a("code",[s._v("sql.yaml")]),s._v("文件中,在程序启动时将该sql文件传入到主程序中,\n就会自动按照要求加载执行sql,于是就有了"),a("code",[s._v("sql文件")]),s._v("的概念")]),s._v(" "),a("h2",{attrs:{id:"相关术语"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#相关术语"}},[s._v("#")]),s._v(" 相关术语")]),s._v(" "),a("p",[s._v("为了方便开发者理解和相互交流,我们把上面引出的,把程序的一系列参数从开发到部署阶段按照特定的格式配置到文件里,这个有特定作用的文件就是项目的 "),a("strong",[a("mark",[a("code",[s._v("配置文件")])])])]),s._v(" "),a("p",[s._v("Flink Sql任务中将提取出来的sql放到"),a("code",[s._v("sql.yaml")]),s._v("中,这个有特定作用的文件就是项目的 "),a("strong",[a("mark",[a("code",[s._v("sql文件")])])])]),s._v(" "),a("h2",{attrs:{id:"配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置文件"}},[s._v("#")]),s._v(" 配置文件")]),s._v(" "),a("p",[s._v("在StreamX中,"),a("code",[s._v("DataStream")]),s._v("作业和"),a("code",[s._v("Flink Sql")]),s._v("作业配置文件是通用的,换言之,这个配置文件既能定义"),a("code",[s._v("DataStream")]),s._v("的各项配置,也能定义"),a("code",[s._v("Flink Sql")]),s._v("的各项配置(Flink Sql作业中配置文件是可选的), 配置文件的格式必须是"),a("code",[s._v("yaml")]),s._v("格式, 必须得符合yaml的格式规范")]),s._v(" "),a("p",[s._v("下面我们来详细看看这个配置文件的各项配置都是如何进行配置的,有哪些注意事项")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("flink")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("deployment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("option")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("target")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" application\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("detached")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("shutdownOnAttachedExit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jobmanager")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("property")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#@see: https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/config.html")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("$internal.application.main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" com.streamxhub.streamx.flink.quickstart.QuickStartApp\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("yarn.application.name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Streamx QuickStart App\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("yarn.application.queue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("taskmanager.numberOfTaskSlots")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("parallelism.default")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jobmanager.memory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("flink.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("heap.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jvm-metaspace.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jvm-overhead.max")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("off-heap.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("process.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("taskmanager.memory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("flink.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("framework.heap.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("framework.off-heap.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("managed.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("process.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("task.heap.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("task.off-heap.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jvm-metaspace.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jvm-overhead.max")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jvm-overhead.min")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("managed.fraction")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.4")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("checkpoints")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("enable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("interval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30000")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" EXACTLY_ONCE\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("timeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("300000")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("unaligned")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("watermark")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("interval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 状态后端")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("state")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("backend")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# see https://ci.apache.org/projects/flink/flink-docs-release-1.12/ops/state/state_backends.html")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" filesystem "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保存类型('jobmanager', 'filesystem', 'rocksdb')")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("memory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5242880")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 针对jobmanager有效,最大内存")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("async")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 针对(jobmanager,filesystem)有效,是否开启异步")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("incremental")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#针对rocksdb有效,是否开启增量")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#rocksdb 的配置参考 https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/config.html#rocksdb-state-backend")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#rocksdb配置key的前缀去掉:state.backend")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#rocksdb.block.blocksize:")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("checkpoints.dir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("///tmp/chkdir\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("savepoints.dir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("///tmp/chkdir\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启策略")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart-strategy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" fixed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("delay  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重启策略[(fixed-delay|failure-rate|none)共3个可配置的策略]")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("fixed-delay")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("attempts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("delay")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("failure-rate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("max-failures-per-interval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("failure-rate-interval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("delay")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# table")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("table")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("planner")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" blink "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# (blink|old|any)")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" streaming "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#(batch|streaming)")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br")])]),a("p",[s._v("上面是关于"),a("code",[s._v("开发时")]),s._v("和"),a("code",[s._v("项目部署")]),s._v("时需要关注的环境相关的完整的配置,这些配置是在"),a("code",[s._v("flink")]),s._v("的namespace下进行配置的,主要分为2大类")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("deployment")]),s._v("下的配置是项目部署相关的配置("),a("code",[s._v("即项目启动时的一系列资源相关的配置参数")]),s._v(")")]),s._v(" "),a("li",[s._v("其他是开发时需要关注的环境相关的配置")])]),s._v(" "),a("p",[s._v("开发时需要关注的环境相关的配置有5项")]),s._v(" "),a("div",{staticClass:"counter"},[a("ul",[a("li",[a("code",[s._v("checkpoints")])]),s._v(" "),a("li",[a("code",[s._v("watermark")])]),s._v(" "),a("li",[a("code",[s._v("state")])]),s._v(" "),a("li",[a("code",[s._v("restart-strategy")])]),s._v(" "),a("li",[a("code",[s._v("table")])])])]),s._v(" "),a("h3",{attrs:{id:"deployment"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#deployment"}},[s._v("#")]),s._v(" Deployment")]),s._v(" "),a("p",[s._v("deployment下放的是部署相关的参数和配置项,具体又分为两类")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("option")])]),s._v(" "),a("li",[a("code",[s._v("property")])])]),s._v(" "),a("h4",{attrs:{id:"option"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#option"}},[s._v("#")]),s._v(" option")]),s._v(" "),a("p",[a("code",[s._v("option")]),s._v("下放的参数是flink run 下支持的参数,目前支持的参数如下\n"),a("ClientOnly",[a("table-data",{attrs:{name:"option"}})],1),s._v(" "),a("code",[s._v("parallelism")]),s._v(" (-p) 并行度不支持在option里配置,会在后面的property里配置\n"),a("code",[s._v("class")]),s._v(" (-c) 程序main不支持在option里配置,会在后面的property里配置")],1),s._v(" "),a("div",{staticClass:"custom-block info"},[a("p",{staticClass:"custom-block-title"},[s._v("注意事项")]),s._v(" "),a("p",[s._v("option下的参数必须是 "),a("code",[s._v("完整参数名")])])]),s._v(" "),a("h4",{attrs:{id:"property"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#property"}},[s._v("#")]),s._v(" property")]),s._v(" "),a("p",[a("code",[s._v("property")]),s._v("下放的参数是标准参数-D下的参数,可以分为两类")]),s._v(" "),a("ul",[a("li",[s._v("基础参数")]),s._v(" "),a("li",[s._v("Memory参数")])]),s._v(" "),a("h5",{attrs:{id:"基础参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基础参数"}},[s._v("#")]),s._v(" 基础参数")]),s._v(" "),a("p",[s._v("基础参数可以配置的选项非常之多,这里举例5个最基础的设置\n"),a("ClientOnly",[a("table-data",{attrs:{name:"property"}})],1)],1),s._v(" "),a("div",{staticClass:"custom-block info"},[a("p",{staticClass:"custom-block-title"},[s._v("注意事项")]),s._v(" "),a("p",[a("code",[s._v("$internal.application.main")]),s._v(" 和 "),a("code",[s._v("yarn.application.name")]),s._v(" 这两个参数是必须的")])]),s._v(" "),a("p",[s._v("如您需要设置更多的参数,可参考"),a("a",{attrs:{href:"https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/config.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("这里")]),a("OutboundLink")],1),s._v("\n一定要将这些参数放到"),a("code",[s._v("property")]),s._v("下,并且参数名称要正确,"),a("code",[s._v("StreamX")]),s._v("会自动解析这些参数并生效")]),s._v(" "),a("h5",{attrs:{id:"memory参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#memory参数"}},[s._v("#")]),s._v(" Memory参数")]),s._v(" "),a("p",[s._v("Memory相关的参数设置也非常之多,一般常见的配置如下")]),s._v(" "),a("ClientOnly",[a("table-data",{attrs:{name:"memory"}})],1),s._v(" "),a("p",[s._v("同样,如你想配置更多的内存相关的参数,请参考"),a("a",{attrs:{href:"https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_setup.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("这里")]),a("OutboundLink")],1),s._v(" 查看"),a("a",{attrs:{href:"https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_setup.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("Flink Process Memory")]),a("OutboundLink")],1),s._v(" , "),a("a",{attrs:{href:"https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_setup_tm.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("jobmanager")]),a("OutboundLink")],1),s._v(" 及 "),a("a",{attrs:{href:"https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_setup_jobmanager.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("taskmanager")]),a("OutboundLink")],1),s._v("\n相关的内存配置将这些参数放到"),a("code",[s._v("property")]),s._v("下,保证参数正确即可生效")]),s._v(" "),a("h5",{attrs:{id:"配置总内存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置总内存"}},[s._v("#")]),s._v(" 配置总内存")]),s._v(" "),a("p",[s._v("Flink JVM 进程的进程总内存（Total Process Memory）包含了由 Flink 应用使用的内存（Flink 总内存）以及由运行 Flink 的 JVM 使用的内存。 Flink 总内存（Total Flink Memory）包括 JVM 堆内存（Heap Memory）和堆外内存（Off-Heap Memory）。 其中堆外内存包括直接内存（Direct Memory）和本地内存（Native Memory）")]),s._v(" "),a("center",[a("img",{attrs:{src:"http://assets.Streamxhub.com/process_mem_model.svg",width:"340px"}})]),s._v(" "),a("p",[s._v("配置 Flink 进程内存最简单的方法是指定以下两个配置项中的任意一个：")]),s._v(" "),a("ClientOnly",[a("table-data",{attrs:{name:"totalMem"}})],1),s._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[s._v("注意事项")]),s._v(" "),a("p",[s._v("不建议同时设置进程总内存和 Flink 总内存。 这可能会造成内存配置冲突，从而导致部署失败。 额外配置其他内存部分时，同样需要注意可能产生的配置冲突。")])]),s._v(" "),a("h3",{attrs:{id:"checkpoints"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#checkpoints"}},[s._v("#")]),s._v(" Checkpoints")]),s._v(" "),a("p",[s._v("Checkpoints 的配置比较简单,按照下面的方式进行配置即可")]),s._v(" "),a("ClientOnly",[a("table-data",{attrs:{name:"checkpoints"}})],1),s._v(" "),a("h3",{attrs:{id:"watermark"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#watermark"}},[s._v("#")]),s._v(" Watermark")]),s._v(" "),a("p",[a("code",[s._v("watermark")]),s._v(" 配置只需要设置下Watermark的生成周期"),a("code",[s._v("interval")]),s._v("即可")]),s._v(" "),a("h3",{attrs:{id:"state"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#state"}},[s._v("#")]),s._v(" State")]),s._v(" "),a("p",[a("code",[s._v("state")]),s._v("是设置状态相关的配置")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("state")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("backend")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# see https://ci.apache.org/projects/flink/flink-docs-release-1.12/ops/state/state_backends.html")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" filesystem "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保存类型('jobmanager', 'filesystem', 'rocksdb')")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("memory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5242880")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 针对jobmanager有效,最大内存")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("async")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 针对(jobmanager,filesystem)有效,是否开启异步")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("incremental")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#针对rocksdb有效,是否开启增量")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#rocksdb 的配置参考 https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/config.html#rocksdb-state-backend")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#rocksdb配置key的前缀去掉:state.backend")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#rocksdb.block.blocksize:")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("checkpoints.dir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("///tmp/chkdir\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("savepoints.dir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("///tmp/chkdir\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("checkpoints.num-retained")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("我们可以看到大体可以分为两类")]),s._v(" "),a("ul",[a("li",[s._v("backend 相关的配置")]),s._v(" "),a("li",[s._v("checkpoints 相关的配置")])]),s._v(" "),a("h4",{attrs:{id:"backend"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#backend"}},[s._v("#")]),s._v(" backend")]),s._v(" "),a("p",[s._v("很直观的,"),a("code",[s._v("backend")]),s._v("下是设置状态后端相关的配置,状态后台的配置遵照"),a("a",{attrs:{href:"https://ci.apache.org/projects/flink/flink-docs-release-1.12/ops/state/state_backends.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("官网文档")]),a("OutboundLink")],1),s._v("的配置规则,在这里支持以下配置")]),s._v(" "),a("ClientOnly",[a("table-data",{attrs:{name:"backend"}})],1),s._v(" "),a("p",[s._v("如果"),a("code",[s._v("backend")]),s._v("的保存类型为"),a("code",[s._v("rocksdb")]),s._v(",则可能要进一步设置"),a("code",[s._v("rocksdb")]),s._v("相关的配置,可以参考"),a("a",{attrs:{href:"https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/config.html#rocksdb-state-backend",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("官网")]),a("OutboundLink")],1),s._v("来进行相关配置,\n需要注意的是官网关于"),a("code",[s._v("rocksdb")]),s._v("的配置都是以"),a("code",[s._v("state.backend")]),s._v("为前缀,而当前的命名空间就是在"),a("code",[s._v("state.backend")]),s._v("下,注意要保证参数名正确")]),s._v(" "),a("div",{staticClass:"custom-block info"},[a("p",{staticClass:"custom-block-title"},[s._v("注意事项")]),s._v(" "),a("p",[a("code",[s._v("value")]),s._v("项非标准配置,该项用来设置状态的保存类型("),a("code",[s._v("jobmanager")]),s._v(" | "),a("code",[s._v("filesystem")]),s._v(" | "),a("code",[s._v("rocksdb")]),s._v("),其他项均为标准配置,遵守官网的规范")])]),s._v(" "),a("h3",{attrs:{id:"restart-strategy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#restart-strategy"}},[s._v("#")]),s._v(" Restart Strategy")]),s._v(" "),a("p",[s._v("重启策略的配置非常直观,在flink中有三种重启策略,对应了这里的三种配置,如下:")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[s._v("  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart-strategy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" fixed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("delay  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重启策略[(fixed-delay|failure-rate|none)共3个可配置的策略]")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("fixed-delay")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("attempts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("delay")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("failure-rate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("max-failures-per-interval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("failure-rate-interval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("delay")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[a("code",[s._v("value")]),s._v("下配置具体的选择哪种重启策略")]),s._v(" "),a("div",{staticClass:"counter"},[a("ul",[a("li",[s._v("fixed-delay")]),s._v(" "),a("li",[s._v("failure-rate")]),s._v(" "),a("li",[s._v("none")])])]),s._v(" "),a("h4",{attrs:{id:"fixed-delay-固定间隔"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fixed-delay-固定间隔"}},[s._v("#")]),s._v(" fixed-delay(固定间隔)")]),s._v(" "),a("ClientOnly",[a("table-data",{attrs:{name:"fixed-delay"}})],1),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("示例")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("attempts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("delay")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 3 s\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("即:任务最大的失败重试次数是"),a("code",[s._v("5次")]),s._v(",每次任务重启的时间间隔是"),a("code",[s._v("3秒")]),s._v(",如果失败次数到达5次,则任务失败退出")])]),s._v(" "),a("h4",{attrs:{id:"failure-rate-失败率"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#failure-rate-失败率"}},[s._v("#")]),s._v(" failure-rate(失败率)")]),s._v(" "),a("ClientOnly",[a("table-data",{attrs:{name:"failure-rate"}})],1),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("示例")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("max-failures-per-interval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("failure-rate-interval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 5 min\n "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("delay")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 2 s\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("即:每次异常重启的时间间隔是"),a("code",[s._v("2秒")]),s._v(",如果在"),a("code",[s._v("5分钟内")]),s._v(",失败总次数到达"),a("code",[s._v("10次")]),s._v(" 则任务失败.")])]),s._v(" "),a("h4",{attrs:{id:"none-无重启"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#none-无重启"}},[s._v("#")]),s._v(" None (无重启)")]),s._v(" "),a("p",[s._v("无重启无需配置任务参数")]),s._v(" "),a("h4",{attrs:{id:"单位后缀"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#单位后缀"}},[s._v("#")]),s._v(" 单位后缀")]),s._v(" "),a("p",[s._v("时间间隔和频率设置需注意,可以不带单位后缀,如果不带单位后缀则默认会当成"),a("code",[s._v("毫秒")]),s._v("来处理,可选的单位有")]),s._v(" "),a("ul",[a("li",[s._v("s    秒")]),s._v(" "),a("li",[s._v("m    分钟")]),s._v(" "),a("li",[s._v("min  分钟")]),s._v(" "),a("li",[s._v("h    小时")]),s._v(" "),a("li",[s._v("d    日")])]),s._v(" "),a("h3",{attrs:{id:"table"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#table"}},[s._v("#")]),s._v(" Table")]),s._v(" "),a("p",[s._v("在"),a("code",[s._v("table")]),s._v("下是Flink Sql相关的配置,目前支持的配置项和作用如下")]),s._v(" "),a("ul",[a("li",[s._v("planner")]),s._v(" "),a("li",[s._v("mode")]),s._v(" "),a("li",[s._v("catalog")]),s._v(" "),a("li",[s._v("database")])]),s._v(" "),a("ClientOnly",[a("table-data",{attrs:{name:"tables"}})],1),s._v(" "),a("h2",{attrs:{id:"sql-文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sql-文件"}},[s._v("#")]),s._v(" Sql 文件")]),s._v(" "),a("p",[s._v("Sql 文件必须是yaml格式的文件,得遵循yaml文件的定义规则,具体内部sql格式的定义非常简单,如下:")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sql")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" datagen "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    f_sequence "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    f_random "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    f_random_str STRING"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    ts "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" localtimestamp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    WATERMARK "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR")]),s._v(" ts "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" ts\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'connector'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'datagen'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- optional options --")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'rows-per-second'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'5'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fields.f_sequence.kind'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sequence'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fields.f_sequence.start'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fields.f_sequence.end'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1000'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fields.f_random.min'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fields.f_random.max'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1000'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fields.f_random_str.length'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'10'")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" print_table "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    f_sequence "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    f_random "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    f_random_str STRING\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'connector'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'print'")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" print_table "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" f_sequence"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("f_random"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("f_random_str "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" datagen"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br")])]),a("p",[a("code",[s._v("sql")]),s._v("为当前sql的id,必须是唯一的,后面的内容则是具体的sql")]),s._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[s._v("特别注意")]),s._v(" "),a("p",[s._v("上面内容中 "),a("strong",[s._v("sql:")]),s._v(" 后面的 "),a("strong",[s._v("|")]),s._v(" 是必带的, 加上 "),a("strong",[s._v("|")]),s._v(" 会保留整段内容的格式,重点是保留了换行符, StreamX封装了Flink Sql的提交,可以直接将多个Sql一次性定义出来,每个Sql必须用 "),a("strong",[s._v(";")]),s._v(" 分割,每段 Sql也必须遵循Flink Sql规定的格式和规范")])]),s._v(" "),a("h2",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),a("p",[s._v("本章节详细介绍了"),a("code",[s._v("配置文件")]),s._v("和"),a("code",[s._v("sql文件")]),s._v("的由来和具体配置,相信你已经有了一个初步的印象和概念,具体使用请查后续章节")])],1)}),[],!1,null,null,null);t.default=e.exports},570:function(s,t,a){"use strict";a.r(t);var n=a(1),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("配置在"),a("code",[s._v("StreamX")]),s._v("中是非常重要的概念,先说说为什么需要配置")]),s._v(" "),a("h2",{attrs:{id:"为什么需要配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为什么需要配置"}},[s._v("#")]),s._v(" 为什么需要配置")]),s._v(" "),a("p",[s._v("开发"),a("code",[s._v("DataStream")]),s._v("程序,大体流程都可以抽象为以下4步")]),s._v(" "),a("div",{staticClass:"counter"},[a("ul",[a("li",[s._v("StreamExecutionEnvironment初始并配置")]),s._v(" "),a("li",[s._v("Source接入数据")]),s._v(" "),a("li",[s._v("Transformation逻辑处理")]),s._v(" "),a("li",[s._v("Sink结果数据落地")])])]),s._v(" "),a("p",[a("img",{attrs:{src:"http://assets.Streamxhub.com/20210317134700.png",alt:""}})]),s._v(" "),a("p",[s._v("开发"),a("code",[s._v("DataStream")]),s._v("程序都需要定义"),a("code",[s._v("Environment")]),s._v("初始化并且配置环境相关的参数,一般我们都会在第一步初始化"),a("code",[s._v("Environment")]),s._v("并配置各种参数,配置的参数大概有以下几类")]),s._v(" "),a("div",{staticClass:"counter"},[a("ul",[a("li",[s._v("Parallelism 默认并行度配置")]),s._v(" "),a("li",[s._v("TimeCharacteristic 时间特征配置")]),s._v(" "),a("li",[s._v("checkpoint 检查点的相关配置")]),s._v(" "),a("li",[s._v("Watermark 相关配置")]),s._v(" "),a("li",[s._v("State Backend 状态后端配置")]),s._v(" "),a("li",[s._v("Restart Strategy 重启策略配置")]),s._v(" "),a("li",[s._v("其他配置...")])])]),s._v(" "),a("p",[s._v("以上的配置基本都是比较普遍且通用的,是每个程序上来第一步就要定义的,是一项重复的工作")]),s._v(" "),a("p",[s._v("当程序写好后,要上线运行,任务启动提交都差不多用下面的命令行的方式,设置各种启动参数,\n这时就得开发者清楚的知道每个参数的含义,如果再设置几个运行时资源参数,那启动命名会很长,可读性很差,参数解析用到了强校验,一旦设置错误,会直接报错,导致任务启动失败,最直接的异常是 "),a("mark",[s._v("找不到程序的jar")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("flink run -m yarn-cluster -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -c com.xx.Main job.jar\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("开发"),a("code",[s._v("Flink Sql")]),s._v("程序,也需要设置一系列环境参数,除此之外,如果要使用纯sql的方式开发,举一个最简单的例子,代码如下")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flink"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("table"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EnvironmentSettings")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flink"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("table"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Table")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flink"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("table"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TableEnvironment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("JavaTableApp")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EnvironmentSettings")]),s._v(" bbSettings "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EnvironmentSettings")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("newInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("useBlinkPlanner")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TableEnvironment")]),s._v(" bsTableEnv "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TableEnvironment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("create")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("bbSettings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" sourceDDL "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CREATE TABLE datagen (  "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" f_random INT,  "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" f_random_str STRING,  "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" ts AS localtimestamp,  "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" WATERMARK FOR ts AS ts  "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('") WITH (  "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\" 'connector' = 'datagen',  \"")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\" 'rows-per-second'='10',  \"")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\" 'fields.f_random.min'='1',  \"")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\" 'fields.f_random.max'='5',  \"")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\" 'fields.f_random_str.length'='10'  \"")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('")"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        bsTableEnv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("executeSql")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sourceDDL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" sinkDDL "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CREATE TABLE print_table ("')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" f_random int,"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" c_val bigint, "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" wStart TIMESTAMP(3) "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\") WITH ('connector' = 'print') \"")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        bsTableEnv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("executeSql")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sinkDDL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br")])]),a("p",[s._v("我们会看到除了设置EnvironmentSettings参数之外,剩下的几乎大段大段的代码都是在写"),a("code",[s._v("sql")]),s._v(",用java代码拼接各种sql,这种编码的方式,极不优雅,如果业务复杂,更是难以维护,而且会发现,整个编码的模式是统一的,\n都是声明一段sql,然后调用"),a("code",[s._v("executeSql")]),s._v("方法")]),s._v(" "),a("p",[a("strong",[s._v("我们的设想是")]),s._v(":能不能以一种更好的方式将这种重复的工作简单化,将"),a("code",[s._v("DataStream")]),s._v("和"),a("code",[s._v("Flink Sql")]),s._v("任务中的一些环境初始化相关的参数和启动相关参数简化,最好一行代码都不写,针对"),a("code",[s._v("Flink Sql")]),s._v("作业,也不想在代码里写大段的sql,能不能以一种更优雅的方式解决?")]),s._v(" "),a("p",[a("strong",[s._v("答案是肯定的")])]),s._v(" "),a("p",[s._v("针对参数设置的问题,在"),a("code",[s._v("StreamX")]),s._v("中提出统一程序配置的概念,把程序的一系列参数从开发到部署阶段按照特定的格式配置到"),a("code",[s._v("application.yml")]),s._v("里,抽象出\n一个通用的配置模板,按照这种规定的格式将上述配置的各项参数在配置文件里定义出来,在程序启动的时候将这个项目配置传入到程序中即可完成环境的初始化工作,在任务启动的时候也会自动识别启动时的参数,于是就有了"),a("code",[s._v("配置文件")]),s._v("这一概念")]),s._v(" "),a("p",[s._v("针对Flink Sql作业在代码里写sql的问题,"),a("code",[s._v("StreamX")]),s._v("针对"),a("code",[s._v("Flink Sql")]),s._v("作业做了更高层级封装和抽象,开发者只需要将sql按照一定的规范要求定义到"),a("code",[s._v("sql.yaml")]),s._v("文件中,在程序启动时将该sql文件传入到主程序中,\n就会自动按照要求加载执行sql,于是就有了"),a("code",[s._v("sql文件")]),s._v("的概念")]),s._v(" "),a("h2",{attrs:{id:"相关术语"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#相关术语"}},[s._v("#")]),s._v(" 相关术语")]),s._v(" "),a("p",[s._v("为了方便开发者理解和相互交流,我们把上面引出的,把程序的一系列参数从开发到部署阶段按照特定的格式配置到文件里,这个有特定作用的文件就是项目的 "),a("strong",[a("mark",[a("code",[s._v("配置文件")])])])]),s._v(" "),a("p",[s._v("Flink Sql任务中将提取出来的sql放到"),a("code",[s._v("sql.yaml")]),s._v("中,这个有特定作用的文件就是项目的 "),a("strong",[a("mark",[a("code",[s._v("sql文件")])])])]),s._v(" "),a("h2",{attrs:{id:"配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置文件"}},[s._v("#")]),s._v(" 配置文件")]),s._v(" "),a("p",[s._v("在StreamX中,"),a("code",[s._v("DataStream")]),s._v("作业和"),a("code",[s._v("Flink Sql")]),s._v("作业配置文件是通用的,换言之,这个配置文件既能定义"),a("code",[s._v("DataStream")]),s._v("的各项配置,也能定义"),a("code",[s._v("Flink Sql")]),s._v("的各项配置(Flink Sql作业中配置文件是可选的), 配置文件的格式必须是"),a("code",[s._v("yaml")]),s._v("格式, 必须得符合yaml的格式规范")]),s._v(" "),a("p",[s._v("下面我们来详细看看这个配置文件的各项配置都是如何进行配置的,有哪些注意事项")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("flink")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("deployment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("option")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("target")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" application\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("detached")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("shutdownOnAttachedExit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jobmanager")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("property")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#@see: https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/config.html")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("$internal.application.main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" com.streamxhub.streamx.flink.quickstart.QuickStartApp\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("yarn.application.name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Streamx QuickStart App\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("yarn.application.queue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("taskmanager.numberOfTaskSlots")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("parallelism.default")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jobmanager.memory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("flink.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("heap.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jvm-metaspace.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jvm-overhead.max")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("off-heap.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("process.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("taskmanager.memory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("flink.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("framework.heap.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("framework.off-heap.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("managed.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("process.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("task.heap.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("task.off-heap.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jvm-metaspace.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jvm-overhead.max")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jvm-overhead.min")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("managed.fraction")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.4")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("checkpoints")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("enable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("interval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30000")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" EXACTLY_ONCE\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("timeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("300000")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("unaligned")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("watermark")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("interval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 状态后端")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("state")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("backend")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# see https://ci.apache.org/projects/flink/flink-docs-release-1.12/ops/state/state_backends.html")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" filesystem "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保存类型('jobmanager', 'filesystem', 'rocksdb')")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("memory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5242880")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 针对jobmanager有效,最大内存")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("async")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 针对(jobmanager,filesystem)有效,是否开启异步")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("incremental")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#针对rocksdb有效,是否开启增量")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#rocksdb 的配置参考 https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/config.html#rocksdb-state-backend")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#rocksdb配置key的前缀去掉:state.backend")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#rocksdb.block.blocksize:")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("checkpoints.dir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("///tmp/chkdir\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("savepoints.dir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("///tmp/chkdir\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启策略")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart-strategy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" fixed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("delay  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重启策略[(fixed-delay|failure-rate|none)共3个可配置的策略]")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("fixed-delay")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("attempts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("delay")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("failure-rate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("max-failures-per-interval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("failure-rate-interval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("delay")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# table")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("table")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("planner")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" blink "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# (blink|old|any)")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" streaming "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#(batch|streaming)")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br")])]),a("p",[s._v("上面是关于"),a("code",[s._v("开发时")]),s._v("和"),a("code",[s._v("项目部署")]),s._v("时需要关注的环境相关的完整的配置,这些配置是在"),a("code",[s._v("flink")]),s._v("的namespace下进行配置的,主要分为2大类")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("deployment")]),s._v("下的配置是项目部署相关的配置("),a("code",[s._v("即项目启动时的一系列资源相关的配置参数")]),s._v(")")]),s._v(" "),a("li",[s._v("其他是开发时需要关注的环境相关的配置")])]),s._v(" "),a("p",[s._v("开发时需要关注的环境相关的配置有5项")]),s._v(" "),a("div",{staticClass:"counter"},[a("ul",[a("li",[a("code",[s._v("checkpoints")])]),s._v(" "),a("li",[a("code",[s._v("watermark")])]),s._v(" "),a("li",[a("code",[s._v("state")])]),s._v(" "),a("li",[a("code",[s._v("restart-strategy")])]),s._v(" "),a("li",[a("code",[s._v("table")])])])]),s._v(" "),a("h3",{attrs:{id:"deployment"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#deployment"}},[s._v("#")]),s._v(" Deployment")]),s._v(" "),a("p",[s._v("deployment下放的是部署相关的参数和配置项,具体又分为两类")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("option")])]),s._v(" "),a("li",[a("code",[s._v("property")])])]),s._v(" "),a("h4",{attrs:{id:"option"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#option"}},[s._v("#")]),s._v(" option")]),s._v(" "),a("p",[a("code",[s._v("option")]),s._v("下放的参数是flink run 下支持的参数,目前支持的参数如下\n"),a("ClientOnly",[a("table-data",{attrs:{name:"option"}})],1),s._v(" "),a("code",[s._v("parallelism")]),s._v(" (-p) 并行度不支持在option里配置,会在后面的property里配置\n"),a("code",[s._v("class")]),s._v(" (-c) 程序main不支持在option里配置,会在后面的property里配置")],1),s._v(" "),a("div",{staticClass:"custom-block info"},[a("p",{staticClass:"custom-block-title"},[s._v("注意事项")]),s._v(" "),a("p",[s._v("option下的参数必须是 "),a("code",[s._v("完整参数名")])])]),s._v(" "),a("h4",{attrs:{id:"property"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#property"}},[s._v("#")]),s._v(" property")]),s._v(" "),a("p",[a("code",[s._v("property")]),s._v("下放的参数是标准参数-D下的参数,可以分为两类")]),s._v(" "),a("ul",[a("li",[s._v("基础参数")]),s._v(" "),a("li",[s._v("Memory参数")])]),s._v(" "),a("h5",{attrs:{id:"基础参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基础参数"}},[s._v("#")]),s._v(" 基础参数")]),s._v(" "),a("p",[s._v("基础参数可以配置的选项非常之多,这里举例5个最基础的设置\n"),a("ClientOnly",[a("table-data",{attrs:{name:"property"}})],1)],1),s._v(" "),a("div",{staticClass:"custom-block info"},[a("p",{staticClass:"custom-block-title"},[s._v("注意事项")]),s._v(" "),a("p",[a("code",[s._v("$internal.application.main")]),s._v(" 和 "),a("code",[s._v("yarn.application.name")]),s._v(" 这两个参数是必须的")])]),s._v(" "),a("p",[s._v("如您需要设置更多的参数,可参考"),a("a",{attrs:{href:"https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/config.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("这里")]),a("OutboundLink")],1),s._v("\n一定要将这些参数放到"),a("code",[s._v("property")]),s._v("下,并且参数名称要正确,"),a("code",[s._v("StreamX")]),s._v("会自动解析这些参数并生效")]),s._v(" "),a("h5",{attrs:{id:"memory参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#memory参数"}},[s._v("#")]),s._v(" Memory参数")]),s._v(" "),a("p",[s._v("Memory相关的参数设置也非常之多,一般常见的配置如下")]),s._v(" "),a("ClientOnly",[a("table-data",{attrs:{name:"memory"}})],1),s._v(" "),a("p",[s._v("同样,如你想配置更多的内存相关的参数,请参考"),a("a",{attrs:{href:"https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_setup.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("这里")]),a("OutboundLink")],1),s._v(" 查看"),a("a",{attrs:{href:"https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_setup.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("Flink Process Memory")]),a("OutboundLink")],1),s._v(" , "),a("a",{attrs:{href:"https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_setup_tm.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("jobmanager")]),a("OutboundLink")],1),s._v(" 及 "),a("a",{attrs:{href:"https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_setup_jobmanager.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("taskmanager")]),a("OutboundLink")],1),s._v("\n相关的内存配置将这些参数放到"),a("code",[s._v("property")]),s._v("下,保证参数正确即可生效")]),s._v(" "),a("h5",{attrs:{id:"配置总内存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置总内存"}},[s._v("#")]),s._v(" 配置总内存")]),s._v(" "),a("p",[s._v("Flink JVM 进程的进程总内存（Total Process Memory）包含了由 Flink 应用使用的内存（Flink 总内存）以及由运行 Flink 的 JVM 使用的内存。 Flink 总内存（Total Flink Memory）包括 JVM 堆内存（Heap Memory）和堆外内存（Off-Heap Memory）。 其中堆外内存包括直接内存（Direct Memory）和本地内存（Native Memory）")]),s._v(" "),a("center",[a("img",{attrs:{src:"http://assets.Streamxhub.com/process_mem_model.svg",width:"340px"}})]),s._v(" "),a("p",[s._v("配置 Flink 进程内存最简单的方法是指定以下两个配置项中的任意一个：")]),s._v(" "),a("ClientOnly",[a("table-data",{attrs:{name:"totalMem"}})],1),s._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[s._v("注意事项")]),s._v(" "),a("p",[s._v("不建议同时设置进程总内存和 Flink 总内存。 这可能会造成内存配置冲突，从而导致部署失败。 额外配置其他内存部分时，同样需要注意可能产生的配置冲突。")])]),s._v(" "),a("h3",{attrs:{id:"checkpoints"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#checkpoints"}},[s._v("#")]),s._v(" Checkpoints")]),s._v(" "),a("p",[s._v("Checkpoints 的配置比较简单,按照下面的方式进行配置即可")]),s._v(" "),a("ClientOnly",[a("table-data",{attrs:{name:"checkpoints"}})],1),s._v(" "),a("h3",{attrs:{id:"watermark"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#watermark"}},[s._v("#")]),s._v(" Watermark")]),s._v(" "),a("p",[a("code",[s._v("watermark")]),s._v(" 配置只需要设置下Watermark的生成周期"),a("code",[s._v("interval")]),s._v("即可")]),s._v(" "),a("h3",{attrs:{id:"state"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#state"}},[s._v("#")]),s._v(" State")]),s._v(" "),a("p",[a("code",[s._v("state")]),s._v("是设置状态相关的配置")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("state")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("backend")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# see https://ci.apache.org/projects/flink/flink-docs-release-1.12/ops/state/state_backends.html")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" filesystem "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保存类型('jobmanager', 'filesystem', 'rocksdb')")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("memory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5242880")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 针对jobmanager有效,最大内存")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("async")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 针对(jobmanager,filesystem)有效,是否开启异步")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("incremental")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#针对rocksdb有效,是否开启增量")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#rocksdb 的配置参考 https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/config.html#rocksdb-state-backend")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#rocksdb配置key的前缀去掉:state.backend")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#rocksdb.block.blocksize:")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("checkpoints.dir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("///tmp/chkdir\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("savepoints.dir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("///tmp/chkdir\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("checkpoints.num-retained")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("我们可以看到大体可以分为两类")]),s._v(" "),a("ul",[a("li",[s._v("backend 相关的配置")]),s._v(" "),a("li",[s._v("checkpoints 相关的配置")])]),s._v(" "),a("h4",{attrs:{id:"backend"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#backend"}},[s._v("#")]),s._v(" backend")]),s._v(" "),a("p",[s._v("很直观的,"),a("code",[s._v("backend")]),s._v("下是设置状态后端相关的配置,状态后台的配置遵照"),a("a",{attrs:{href:"https://ci.apache.org/projects/flink/flink-docs-release-1.12/ops/state/state_backends.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("官网文档")]),a("OutboundLink")],1),s._v("的配置规则,在这里支持以下配置")]),s._v(" "),a("ClientOnly",[a("table-data",{attrs:{name:"backend"}})],1),s._v(" "),a("p",[s._v("如果"),a("code",[s._v("backend")]),s._v("的保存类型为"),a("code",[s._v("rocksdb")]),s._v(",则可能要进一步设置"),a("code",[s._v("rocksdb")]),s._v("相关的配置,可以参考"),a("a",{attrs:{href:"https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/config.html#rocksdb-state-backend",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("官网")]),a("OutboundLink")],1),s._v("来进行相关配置,\n需要注意的是官网关于"),a("code",[s._v("rocksdb")]),s._v("的配置都是以"),a("code",[s._v("state.backend")]),s._v("为前缀,而当前的命名空间就是在"),a("code",[s._v("state.backend")]),s._v("下,注意要保证参数名正确")]),s._v(" "),a("div",{staticClass:"custom-block info"},[a("p",{staticClass:"custom-block-title"},[s._v("注意事项")]),s._v(" "),a("p",[a("code",[s._v("value")]),s._v("项非标准配置,该项用来设置状态的保存类型("),a("code",[s._v("jobmanager")]),s._v(" | "),a("code",[s._v("filesystem")]),s._v(" | "),a("code",[s._v("rocksdb")]),s._v("),其他项均为标准配置,遵守官网的规范")])]),s._v(" "),a("h3",{attrs:{id:"restart-strategy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#restart-strategy"}},[s._v("#")]),s._v(" Restart Strategy")]),s._v(" "),a("p",[s._v("重启策略的配置非常直观,在flink中有三种重启策略,对应了这里的三种配置,如下:")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[s._v("  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart-strategy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" fixed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("delay  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重启策略[(fixed-delay|failure-rate|none)共3个可配置的策略]")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("fixed-delay")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("attempts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("delay")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("failure-rate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("max-failures-per-interval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("failure-rate-interval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("delay")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[a("code",[s._v("value")]),s._v("下配置具体的选择哪种重启策略")]),s._v(" "),a("div",{staticClass:"counter"},[a("ul",[a("li",[s._v("fixed-delay")]),s._v(" "),a("li",[s._v("failure-rate")]),s._v(" "),a("li",[s._v("none")])])]),s._v(" "),a("h4",{attrs:{id:"fixed-delay-固定间隔"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fixed-delay-固定间隔"}},[s._v("#")]),s._v(" fixed-delay(固定间隔)")]),s._v(" "),a("ClientOnly",[a("table-data",{attrs:{name:"fixed-delay"}})],1),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("示例")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("attempts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("delay")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 3 s\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("即:任务最大的失败重试次数是"),a("code",[s._v("5次")]),s._v(",每次任务重启的时间间隔是"),a("code",[s._v("3秒")]),s._v(",如果失败次数到达5次,则任务失败退出")])]),s._v(" "),a("h4",{attrs:{id:"failure-rate-失败率"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#failure-rate-失败率"}},[s._v("#")]),s._v(" failure-rate(失败率)")]),s._v(" "),a("ClientOnly",[a("table-data",{attrs:{name:"failure-rate"}})],1),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("示例")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("max-failures-per-interval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("failure-rate-interval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 5 min\n "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("delay")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 2 s\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("即:每次异常重启的时间间隔是"),a("code",[s._v("2秒")]),s._v(",如果在"),a("code",[s._v("5分钟内")]),s._v(",失败总次数到达"),a("code",[s._v("10次")]),s._v(" 则任务失败.")])]),s._v(" "),a("h4",{attrs:{id:"none-无重启"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#none-无重启"}},[s._v("#")]),s._v(" None (无重启)")]),s._v(" "),a("p",[s._v("无重启无需配置任务参数")]),s._v(" "),a("h4",{attrs:{id:"单位后缀"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#单位后缀"}},[s._v("#")]),s._v(" 单位后缀")]),s._v(" "),a("p",[s._v("时间间隔和频率设置需注意,可以不带单位后缀,如果不带单位后缀则默认会当成"),a("code",[s._v("毫秒")]),s._v("来处理,可选的单位有")]),s._v(" "),a("ul",[a("li",[s._v("s    秒")]),s._v(" "),a("li",[s._v("m    分钟")]),s._v(" "),a("li",[s._v("min  分钟")]),s._v(" "),a("li",[s._v("h    小时")]),s._v(" "),a("li",[s._v("d    日")])]),s._v(" "),a("h3",{attrs:{id:"table"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#table"}},[s._v("#")]),s._v(" Table")]),s._v(" "),a("p",[s._v("在"),a("code",[s._v("table")]),s._v("下是Flink Sql相关的配置,目前支持的配置项和作用如下")]),s._v(" "),a("ul",[a("li",[s._v("planner")]),s._v(" "),a("li",[s._v("mode")]),s._v(" "),a("li",[s._v("catalog")]),s._v(" "),a("li",[s._v("database")])]),s._v(" "),a("ClientOnly",[a("table-data",{attrs:{name:"tables"}})],1),s._v(" "),a("h2",{attrs:{id:"sql-文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sql-文件"}},[s._v("#")]),s._v(" Sql 文件")]),s._v(" "),a("p",[s._v("Sql 文件必须是yaml格式的文件,得遵循yaml文件的定义规则,具体内部sql格式的定义非常简单,如下:")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sql")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" datagen "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    f_sequence "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    f_random "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    f_random_str STRING"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    ts "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" localtimestamp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    WATERMARK "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR")]),s._v(" ts "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" ts\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'connector'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'datagen'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- optional options --")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'rows-per-second'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'5'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fields.f_sequence.kind'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sequence'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fields.f_sequence.start'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fields.f_sequence.end'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1000'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fields.f_random.min'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fields.f_random.max'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1000'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fields.f_random_str.length'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'10'")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" print_table "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    f_sequence "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    f_random "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    f_random_str STRING\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'connector'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'print'")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" print_table "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" f_sequence"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("f_random"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("f_random_str "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" datagen"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br")])]),a("p",[a("code",[s._v("sql")]),s._v("为当前sql的id,必须是唯一的,后面的内容则是具体的sql")]),s._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[s._v("特别注意")]),s._v(" "),a("p",[s._v("上面内容中 "),a("strong",[s._v("sql:")]),s._v(" 后面的 "),a("strong",[s._v("|")]),s._v(" 是必带的, 加上 "),a("strong",[s._v("|")]),s._v(" 会保留整段内容的格式,重点是保留了换行符, StreamX封装了Flink Sql的提交,可以直接将多个Sql一次性定义出来,每个Sql必须用 "),a("strong",[s._v(";")]),s._v(" 分割,每段 Sql也必须遵循Flink Sql规定的格式和规范")])]),s._v(" "),a("h2",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),a("p",[s._v("本章节详细介绍了"),a("code",[s._v("配置文件")]),s._v("和"),a("code",[s._v("sql文件")]),s._v("的由来和具体配置,相信你已经有了一个初步的印象和概念,具体使用请查后续章节")])],1)}),[],!1,null,null,null);t.default=e.exports}}]);